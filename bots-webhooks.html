<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#B42F42"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-02-02T18:59:30.6425092"><title>Bot de Telegram con Webhooks | Dangos.dev</title><script type="application/json" id="virtual-toc-data">[{"id":"requisitos-previos","level":0,"title":"Requisitos previos","anchor":"#requisitos-previos"},{"id":"arquitectura","level":0,"title":"Arquitectura del sistema","anchor":"#arquitectura"},{"id":"-e0oqjb_7","level":0,"title":"Implementación","anchor":"#-e0oqjb_7"},{"id":"-e0oqjb_8","level":0,"title":"Flujo de trabajo del Webhook","anchor":"#-e0oqjb_8"},{"id":"-e0oqjb_9","level":0,"title":"Despliegue en producción","anchor":"#-e0oqjb_9"},{"id":"-e0oqjb_10","level":0,"title":"Conclusión","anchor":"#-e0oqjb_10"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="frontend/app.css" rel="stylesheet"><link rel="icon" type="image/png" sizes="16x16" href="images/logo-dango.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Bot de Telegram con Webhooks | Dangos.dev"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Dangos.dev Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/bots-webhooks.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Bot de Telegram con Webhooks | Dangos.dev"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/bots-webhooks.html#webpage",
    "url": "writerside-documentation/bots-webhooks.html",
    "name": "Bot de Telegram con Webhooks | Dangos.dev",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Dangos.dev Help"
}</script><!-- End Schema.org --></head><body data-id="Bots-Webhooks" data-main-title="Bot de Telegram con Webhooks" data-article-props="{&quot;seeAlso&quot;:[{&quot;title&quot;:&quot;Recursos externos&quot;,&quot;links&quot;:[{&quot;url&quot;:&quot;https://github.com/dangos-dev/TelegramBot.Webhook&quot;,&quot;text&quot;:&quot;Repositorio y código fuente de este artículo&quot;},{&quot;url&quot;:&quot;https://core.telegram.org/bots&quot;,&quot;text&quot;:&quot;Documentación oficial de Bots de Telegram&quot;},{&quot;url&quot;:&quot;https://python-telegram-bot.org/&quot;,&quot;text&quot;:&quot;python-telegram-bot Documentation&quot;},{&quot;url&quot;:&quot;https://fastapi.tiangolo.com/deployment/&quot;,&quot;text&quot;:&quot;FastAPI Deployment Guide&quot;}]}],&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Bots de Telegram"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Dangos.dev  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Bots-Webhooks" data-label-id="python" data-annotation-ids="telegram-bot" id="Bots-Webhooks.topic">Bot de Telegram con Webhooks</h1><p id="-e0oqjb_4">Los bots de Telegram pueden implementarse mediante dos m&eacute;todos principales: <b id="-e0oqjb_12">polling</b> (sondeo peri&oacute;dico) y <b id="-e0oqjb_13">webhooks</b>. Los webhooks ofrecen ventajas en producci&oacute;n al eliminar la necesidad de conexiones persistentes y reducir la latencia en la entrega de actualizaciones. En este art&iacute;culo exploraremos una implementaci&oacute;n t&eacute;cnica usando Python, FastAPI y la biblioteca <code class="code" id="-e0oqjb_14">python-telegram-bot</code>.</p><section class="chapter"><h2 id="requisitos-previos" data-toc="requisitos-previos">Requisitos previos</h2><section class="procedure-steps" id="-e0oqjb_15"><ol class="list _decimal"><li class="list__item" id="-e0oqjb_16"><p>Python 3.10+ instalado</p></li><li class="list__item" id="-e0oqjb_17"><p>Cuenta de Telegram y @BotFather para crear un bot</p></li><li class="list__item" id="-e0oqjb_18"><p>ngrok para pruebas locales (opcional)</p></li><li class="list__item" id="-e0oqjb_19"><p>Cuenta en Railway para despliegue (opcional)</p></li></ol></section></section><section class="chapter"><h2 id="arquitectura" data-toc="arquitectura">Arquitectura del sistema</h2><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 309.7109375 454"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="309.7109375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M138.431,62L131.393,68.167C124.355,74.333,110.279,86.667,103.241,95.917C96.203,105.167,96.203,111.333,96.203,116.833C96.203,122.333,96.203,127.167,96.203,129.583L96.203,132"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_C_1" d="M96.203,190L96.203,196.167C96.203,202.333,96.203,214.667,96.203,223.917C96.203,233.167,96.203,239.333,96.203,244.833C96.203,250.333,96.203,255.167,96.203,257.583L96.203,260"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_D_2" d="M96.203,318L96.203,324.167C96.203,330.333,96.203,342.667,99.722,351.917C103.241,361.167,110.279,367.333,116.816,373.061C123.352,378.788,129.387,384.076,132.405,386.72L135.423,389.364"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_A_3" d="M200.061,392L207.099,385.833C214.137,379.667,228.213,367.333,235.251,350.5C242.289,333.667,242.289,312.333,242.289,291C242.289,269.667,242.289,248.333,242.289,227C242.289,205.667,242.289,184.333,242.289,163C242.289,141.667,242.289,120.333,238.77,106.583C235.251,92.833,228.213,86.667,221.676,80.939C215.14,75.212,209.105,69.924,206.087,67.28L203.07,64.636"></path></g><g class="edgeLabels"><g transform="translate(96.203125, 99)" class="edgeLabel"><g transform="translate(-76.78125, -12)" class="label"><foreignObject height="24" width="153.5625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Envía actualizaciones</p></span></div></foreignObject></g></g><g transform="translate(96.203125, 227)" class="edgeLabel"><g transform="translate(-66.6640625, -12)" class="label"><foreignObject height="24" width="133.328125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Procesa peticiones</p></span></div></foreignObject></g></g><g transform="translate(96.203125, 355)" class="edgeLabel"><g transform="translate(-50.984375, -12)" class="label"><foreignObject height="24" width="101.96875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Ejecuta lógica</p></span></div></foreignObject></g></g><g transform="translate(242.2890625, 227)" class="edgeLabel"><g transform="translate(-59.421875, -12)" class="label"><foreignObject height="24" width="118.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Envía respuestas</p></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(169.24609375, 35)" id="flowchart-A-104" class="node default"><rect height="54" width="182.515625" y="-27" x="-91.2578125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-61.2578125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="122.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Telegram Servers</p></span></div></foreignObject></g></g><g transform="translate(96.203125, 163)" id="flowchart-B-105" class="node default"><rect height="54" width="157.40625" y="-27" x="-78.703125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.703125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="97.40625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Webhook URL</p></span></div></foreignObject></g></g><g transform="translate(96.203125, 291)" id="flowchart-C-107" class="node default"><rect height="54" width="176.40625" y="-27" x="-88.203125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-58.203125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="116.40625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Servidor FastAPI</p></span></div></foreignObject></g></g><g transform="translate(169.24609375, 419)" id="flowchart-D-109" class="node default"><rect height="54" width="126.234375" y="-27" x="-63.1171875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-33.1171875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="66.234375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Bot Logic</p></span></div></foreignObject></g></g></g></g></g></svg></section><section class="chapter"><h2 id="-e0oqjb_7" data-toc="-e0oqjb_7">Implementaci&oacute;n</h2><p id="-e0oqjb_21">Crea un nuevo entorno virtual e instala las dependencias:</p><div class="code-block" data-lang="bash">
                    python -m venv venv
                    source venv/bin/activate  # Linux/Mac
                    venv\Scripts\activate.bat # Windows
                    pip install fastapi hypercorn python-telegram-bot python-dotenv
                </div><p id="-e0oqjb_23">Configura las variables de entorno:</p><div class="code-block" data-lang="none">
            TELEGRAM_BOT_TOKEN=tu_token_aqui
            RAILWAY_PUBLIC_DOMAIN=https://tudominio.com
        </div><p id="-e0oqjb_25">Inicializa el bot con utilizando el m&eacute;todo <code class="code" id="-e0oqjb_32">Application.builder()</code>:</p><div class="code-block" data-lang="python">
            from telegram.ext import Application

            bot_builder = (
                Application.builder()
                .token(os.getenv('TELEGRAM_BOT_TOKEN'))
                .updater(None)  # Desactiva el updater para webhooks
                .build()
            )
        </div><p id="-e0oqjb_27">Configura el servicio con FastAPI:</p><div class="code-block" data-lang="python">
            @asynccontextmanager
            async def lifespan(_: FastAPI):
                await bot_builder.bot.setWebhook(WEBHOOK_DOMAIN)
                async with bot_builder:
                    await bot_builder.start()
                    yield
                    await bot_builder.stop()

            app = FastAPI(lifespan=lifespan)
        </div><p id="-e0oqjb_29">Define el endpoint de entrada que procesar&aacute; las actualizaciones recibidas desde Telegram:</p><div class="code-block" data-lang="python">
            @app.post(&quot;/&quot;)
            async def process_update(request: Request):
                update = Update.de_json(await request.json(), bot_builder.bot)
                await bot_builder.process_update(update)
                return Response(status_code=HTTPStatus.OK)
        </div><section class="chapter"><h3 id="-e0oqjb_31" data-toc="-e0oqjb_31">Handlers</h3><p id="-e0oqjb_33">Los <b id="-e0oqjb_36">handlers</b> son componentes que definen c&oacute;mo tu bot responde a diferentes tipos de mensajes o eventos. Act&uacute;an como &quot;escuchas&quot; que reaccionan a comandos, mensajes, o interacciones espec&iacute;ficas, y ejecutan funciones asociadas (<b id="-e0oqjb_37">llamadas callback functions</b>).</p><section class="chapter"><h4 id="-e0oqjb_34" data-toc="-e0oqjb_34">Ejemplo 1: Manejar comando /start</h4><div class="code-block" data-lang="python">
                    async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
                        await update.message.reply_text(&quot;¡Bot activado! 🚀&quot;)

                    bot_builder.add_handler(CommandHandler(&quot;start&quot;, start))
            </div></section><section class="chapter"><h4 id="-e0oqjb_35" data-toc="-e0oqjb_35">Ejemplo 2: Manejar mensajes de texto</h4><div class="code-block" data-lang="python">
                    async def echo(update: Update, context: ContextTypes.DEFAULT_TYPE):
                        await update.message.reply_text(update.message.text)

                    bot_builder.add_handler(MessageHandler(filters.TEXT &amp; ~filters.COMMAND, echo))
            </div></section></section></section><section class="chapter"><h2 id="-e0oqjb_8" data-toc="-e0oqjb_8">Flujo de trabajo del Webhook</h2><ol class="list _decimal" id="-e0oqjb_40" type="1"><li class="list__item" id="-e0oqjb_41"><p><b id="-e0oqjb_46">Registro del webhook</b>: Al iniciar la aplicaci&oacute;n, se configura la URL en Telegram</p></li><li class="list__item" id="-e0oqjb_42"><p><b id="-e0oqjb_47">Recepci&oacute;n de actualizaciones</b>: Telegram env&iacute;a actualizaciones via POST a nuestro endpoint</p></li><li class="list__item" id="-e0oqjb_43"><p><b id="-e0oqjb_48">Procesamiento</b>: FastAPI deserializa el JSON y lo convierte en un objeto <code class="code" id="-e0oqjb_49">Update</code></p></li><li class="list__item" id="-e0oqjb_44"><p><b id="-e0oqjb_50">Ejecuci&oacute;n de handlers</b>: La aplicaci&oacute;n de bot procesa la actualizaci&oacute;n con los handlers registrados</p></li><li class="list__item" id="-e0oqjb_45"><p><b id="-e0oqjb_51">Respuesta</b>: El bot env&iacute;a respuestas mediante llamadas a la API de Telegram&quot;</p></li></ol></section><section class="chapter"><h2 id="-e0oqjb_9" data-toc="-e0oqjb_9">Despliegue en producci&oacute;n</h2><section class="procedure-steps"><h3 id="-e0oqjb_52" data-toc="-e0oqjb_52">Usando Railway</h3><p><a href="https://railway.com/template/5kprwG?referralCode=Al2B-n" id="-e0oqjb_53" data-external="true" rel="noopener noreferrer"><img alt="Button" src="https://railway.com/button.svg" class="inline-icon-" title="Button" id="-e0oqjb_57"></a></p><ol class="list _decimal"><li class="list__item" id="-e0oqjb_54"><p>Crea un nuevo proyecto desde la plantilla</p></li><li class="list__item" id="-e0oqjb_55"><p>Configura las variables de entorno en el panel de control</p></li><li class="list__item" id="-e0oqjb_56"><p>Despliega con un clic usando el bot&oacute;n proporcionado</p></li></ol></section></section><section class="chapter"><h2 id="-e0oqjb_10" data-toc="-e0oqjb_10">Conclusi&oacute;n</h2><p id="-e0oqjb_58">Esta implementaci&oacute;n combina la eficiencia de FastAPI con la flexibilidad de python-telegram-bot para crear bots escalables. Los webhooks son ideales para entornos de producci&oacute;n donde el rendimiento y la eficiencia en el uso de recursos son cr&iacute;ticos.</p></section><div class="last-modified">Last modified: 02 February 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="deepseek-en-raspberry-pi-5.html" class="navigation-links__prev">Deepseek en Raspberry PI 5</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="frontend/app.js"></script></body></html>